{"version":3,"sources":["Form.jsx"],"names":[],"mappings":";;;;;;;;;;AAYA;;;;AACA;;;;AAEA;;;;;;;;;;;;+eAfA;;;;;;AAMA;;;;;;IAWqB,I;;;AACnB,gBAAY,KAAZ,EAAmB;AAAA;;AAAA,wFACX,KADW;;AAGjB,UAAK,KAAL,GAAa,EAAb;AACA,UAAK,MAAL,GAAc,EAAd;AACA,UAAK,SAAL;;AAEA,UAAK,SAAL,GAAiB,MAAK,SAAL,CAAe,IAAf,OAAjB;AACA,UAAK,WAAL,GAAmB,MAAK,WAAL,CAAiB,IAAjB,OAAnB;AARiB;AASlB;;;;sCAeiB;AAChB,aAAO;AACL,cAAM;AACJ,uBAAa,KAAK;AADd;AADD,OAAP;AAKD;;AAED;;;;gCACY,I,EAAM,Q,EAAU;AAC1B,WAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB;AACA,WAAK,MAAL,CAAY,IAAZ,IAAoB,QAApB;AACD;;AAED;;;;gCACY;AAAA;;AACV,UAAM,SAAS,EAAf;;AAEA,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,GAAD,EAAS;AAC1B,YAAI,QAAQ,OAAK,MAAL,CAAY,GAAZ,CAAZ;;AAEA,eAAO,MAAP,CAAc,MAAd,sBACG,GADH,EACS,MAAM,QAAN,EADT;AAGD,OAND;;AAQA,aAAO,MAAP;AACD;;;kCAEa,I,EAAM;AAClB,aAAO,KAAK,MAAL,CAAY,IAAZ,EAAkB,QAAlB,EAAP;AACD;;;kCAEa,I,EAAM,K,EAAO;AACzB;AACA,aAAO,KAAK,MAAL,CAAY,IAAZ,EAAkB,QAAlB,CAA2B,KAA3B,EAAkC,IAAlC,CAAP;AACD;;;yCAE6B;AAAA;;AAAA,UAAX,KAAW,yDAAH,CAAG;;AAC5B,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,GAAD,EAAS;AAC1B,YAAI,QAAQ,OAAK,KAAL,CAAW,GAAX,CAAZ;;AAEA,YAAI,CAAC,MAAM,OAAN,EAAL,EAAsB;AACpB,cAAI,UAAU,CAAd,EAAiB;AACf,kBAAM,YAAN;AACD;;AAED;AACD;AACF,OAVD;AAWD;;;6BAEQ;AAAA;;AAAA,mBACsC,KAAK,KAD3C;AAAA,UACC,SADD,UACC,SADD;AAAA,UACY,SADZ,UACY,SADZ;AAAA,UACuB,UADvB,UACuB,UADvB;;;AAGP,UAAM,iDACH,SADG,EACS,CAAC,CAAC,SADX,4BAEH,SAFG,EAES,IAFT,4BAGA,SAHA,UAGiB,UAHjB,WAAN;;AAMA,aACE;AAAA;AAAA,UAAM,YAAN,EAAa,WAAW,0BAAW,MAAX,CAAxB;AACG,aAAK,KAAL,CAAW;AADd,OADF;AAKD;;;;EA3F+B,gBAAM,S;;AAAnB,I,CAYZ,Y,GAAe;AACpB,aAAW,SADS;AAEpB,cAAY;AAFQ,C;AAZH,I,CAiBZ,S,GAAY;AACjB,cAAY,iBAAU;AADL,C;AAjBA,I,CAqBZ,iB,GAAoB;AACzB,QAAM,iBAAU;AADS,C;kBArBR,I","file":"Form.jsx","sourcesContent":["/**\r\n * imui.Form\r\n * @author moxhe\r\n * @date 2016-08-08\r\n */\r\n\r\n/**\r\n * 主要功能\r\n * 1. 表单排布\r\n * 2. 利用context构造API\r\n */\r\n\r\nimport React, { PropTypes } from 'react';\r\nimport classnames from 'classnames';\r\n\r\nimport Validator from './validator';\r\n\r\nexport default class Form extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.names = [];\r\n    this.fields = {};\r\n    this.validator = Validator;\r\n\r\n    this.getValues = this.getValues.bind(this);\r\n    this.attachField = this.attachField.bind(this);\r\n  }\r\n\r\n  static defaultProps = {\r\n    prefixCls: 'im-form',\r\n    horizontal: true\r\n  };\r\n\r\n  static PropTypes = {\r\n    horizontal: PropTypes.bool\r\n  };\r\n\r\n  static childContextTypes = {\r\n    form: PropTypes.object\r\n  };\r\n\r\n  getChildContext() {\r\n    return {\r\n      form: {\r\n        attachField: this.attachField\r\n      }\r\n    };\r\n  }\r\n\r\n  // Form结构建立\r\n  attachField(name, instance) {\r\n    this.names.push(name);\r\n    this.fields[name] = instance;\r\n  }\r\n\r\n  // APIs\r\n  getValues() {\r\n    const values = {};\r\n\r\n    this.names.forEach((key) => {\r\n      let field = this.fields[key];\r\n\r\n      Object.assign(values, {\r\n        [key]: field.getValue()\r\n      });\r\n    });\r\n\r\n    return values;\r\n  }\r\n\r\n  getFieldValue(name) {\r\n    return this.fields[name].getValue();\r\n  }\r\n\r\n  setFieldValue(name, value) {\r\n    // 默认不触发校验\r\n    return this.fields[name].setValue(value, true);\r\n  }\r\n\r\n  scrollToErrorField(index = 0) {\r\n    this.names.forEach((key) => {\r\n      let field = this.field[key];\r\n\r\n      if (!field.isValid()) {\r\n        if (index === 0) {\r\n          field.scrollToSelf();\r\n        }\r\n\r\n        index--;\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { className, prefixCls, horizontal } = this.props;\r\n\r\n    const allCls = {\r\n      [className]: !!className,\r\n      [prefixCls]: true,\r\n      [`${prefixCls}--h`]: horizontal\r\n    };\r\n\r\n    return (\r\n      <form action className={classnames(allCls)}>\r\n        {this.props.children}\r\n      </form>\r\n    );\r\n  }\r\n}\r\n"]}